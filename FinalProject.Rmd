---
title: "R Notebook"
author: "Eric Schneider"
output: html_notebook
---

## Front Matter

```{r}
# clean up workspace environment
rm(list = ls())

# all packages used for the assignment
library(dplyr)
library(DataComputing)
library(rvest)
library(tidyr)
library(ggplot2)
library(mosaic)
```


## Load in Data
```{r}
page <- "https://en.wikipedia.org/wiki/List_of_National_Basketball_Association_career_scoring_leaders"
tableList <- page %>%
  read_html() %>%
  html_nodes(css = "table") %>%
  html_table(fill = TRUE)
Data <- (tableList[[2]])
```

```{r}
page <- "https://www.basketball-reference.com/leagues/NBA_2019_per_game.html"
tableList <- page %>%
  read_html() %>%
  html_nodes(css = "table") %>%
  html_table(fill = TRUE)
g20189 <- (tableList[[1]])
```

```{r}
page <- "https://www.basketball-reference.com/leagues/NBA_2018_per_game.html"
tableList <- page %>%
  read_html() %>%
  html_nodes(css = "table") %>%
  html_table(fill = TRUE)
g20178 <- (tableList[[1]])
```

```{r}
page <- "https://www.basketball-reference.com/leagues/NBA_2017_per_game.html"
tableList <- page %>%
  read_html() %>%
  html_nodes(css = "table") %>%
  html_table(fill = TRUE)
g20167 <- (tableList[[1]])
```

# Inspect new imported data tables
```{r}
head(g20167)
head(Data)
```
# Guiding question: Look at Stats by position over the 3 years and compare what positions are best at what stat and and compare recent years stats to all time stats

# Add year variable to tables to be able to determine stats by year when joined
```{r}
g20189 <- mutate(g20189, year = '2018-9')
g20178 <- mutate(g20178, year = '2017-8')
g20167 <- mutate(g20167, year = '2016-7')
```

# Join the 3 yearly tables 
```{r}
allYears <- full_join(g20167,g20178)
allYears <- full_join(allYears,g20189)
```

# Seperate allYears table by position

# Gets average of 5 big stats by Position
```{r}
SG <- filter(allYears, Pos == 'SG')
PF <- filter(allYears, Pos == 'PF')
C <- filter(allYears, Pos == 'C')
SF <- filter(allYears, Pos == 'SF')
PG <- filter(allYears, Pos == 'PG')
```

```{r}
target <- c("C", "PG", "SG", "PF", "SF")

points <- allYears %>%
filter(Pos %in% target) %>%
group_by(Pos) %>%
summarise(PPG = mean(as.numeric(PTS))) 


assists <- allYears %>%
filter(Pos %in% target) %>%
group_by(Pos) %>%
summarise(APG = mean(as.numeric(AST))) 


steals <- allYears %>%
filter(Pos %in% target) %>%
group_by(Pos) %>%
summarise(SPG = mean(as.numeric(STL))) 


blocks <- allYears %>%
filter(Pos %in% target) %>%
group_by(Pos) %>%
summarise(BPG = mean(as.numeric(BLK))) 


turnover <- allYears %>%
filter(Pos %in% target) %>%
group_by(Pos) %>%
summarise(TOVPG = mean(as.numeric(TOV))) 

```

```{r}
all_stats <- full_join(points,assists)
all_stats <- full_join(all_stats,steals)
all_stats <- full_join(all_stats,blocks)
all_stats <- full_join(all_stats,turnover)
all_stats <- filter(all_stats, Pos != 'Pos')
```

# Presentation Graph
```{r}
points_graph <- ggplot(data=all_stats,aes(x=Pos,y=PPG ))+geom_bar(stat='identity',position='stack', width=.9) 
assist_graph <- ggplot(data=all_stats,aes(x=Pos,y=APG ))+geom_bar(stat='identity',position='stack', width=.9) 
block_graph <- ggplot(data=all_stats,aes(x=Pos,y=BPG ))+geom_bar(stat='identity',position='stack', width=.9) 
turn_graph <- ggplot(data=all_stats,aes(x=Pos,y=TOVPG ))+geom_bar(stat='identity',position='stack', width=.9) 
steal_graph <- ggplot(data=all_stats,aes(x=Pos,y=SPG ))+geom_bar(stat='identity',position='stack', width=.9) 

final <- plot_grid(points_graph, assist_graph, steal_graph, turn_graph, block_graph)

ggsave('statfinaltest.pdf',final)
```
